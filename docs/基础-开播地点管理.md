# 基础-开播地点管理（原“基础-战斗区域管理”）

> 术语统一记录（2025-09-26）
> - 历史用语→统一用语：机师→主播；舰长→运营；议长→管理员；战斗区域→开播地点；X坐标→基地；Y坐标→场地；Z坐标→坐席。
> - 本次复核（2025-09-26）：已完成逐段术语检查，正文采用统一用语；数据库/接口字段仍保留历史命名，仅以字段标注说明。

开播地点其实就是主播用来开播的设备/位置编号，因为之后会设计通告管理系统，需要为主播什么时间在哪里（开播地点）开播进行通告排程。

这是是用于进行通告排程的元数据之一的开播地点的管理模块。

本功能模块只有管理员有权限，运营无权访问。

## 基本约定

- 开播地点可以被禁用，但是无法删除

## 元数据

| 字段 | 说明 | 参考类型 | 设定 |
|---------|------|------|------|
| ID | 系统中内部使用的唯一编码，用户不可见 | 由技术设计 | 必须 唯一 |
| 基地（原X坐标） | 其实就是大类，比如“无锡50” | 字符串 | 必须 |
| 场地（原Y坐标） | 其实就是小类，比如“房间A” | 字符串 | 必须 |
| 坐席（原Z坐标） | 其实就是具体的座位号，比如“11” | 字符串 | 必须 |
| 可用性 | 可用 / 禁用 | 枚举型 | 必须，默认=可用 |

### 元数据之间的关联

- 基地 + 场地 + 坐席 不能有重复，定义成复合唯一键（数据库字段仍为 X/Y/Z）。

### 交叉关联

- 未来通告会交叉关联到这里

## 管理界面

管理界面的设计参考 主播-主播管理 模块的实现，尽可能统一（文件名与数据库字段保持历史称谓不变）。页面数据及动作通过 REST 接口 `/api/battle-areas` 家族完成。

### 列表

- 按 基地 / 场地 / 坐席 的字典顺序排列（坐席字段按字符串排序）。
- 展示字段
    - 基地（X） - 场地（Y） - 坐席（Z）
    - 可用性
- 点击进入开播地点详情

底部footbar：新建开播地点按钮：新建开播地点

#### 筛选

- 基地（X）
- 场地（Y）
- 可用性

选择基地后，场地筛选器中只留下当前基地下存在的场地（去重）。

所有筛选条件可以组合成复合筛选（交集）；

筛选条件通过 `persist_and_restore_filters` 写入用户 session（保持与其他模块一致的命名空间）。

#### 默认筛选器

- 所有角色：
    - 可用性 = 可用

### 开播地点详情

展示一个具体的开播地点的信息。

底部：编辑按钮 生成更多按钮

### 开播地点新建 / 编辑

略

### 开播地点生成

点击生成更多按钮进入本UI。

从源开播地点复制
- 基地（X，不可编辑）
- 场地（Y，不可编辑）
- 坐席开始（Z，数字）
- 坐席结束（Z，数字）

底部：生成按钮

#### 生成步骤

- 检查坐席开始是数字
- 检查坐席结束是数字
- 检查坐席开始小于坐席结束
- 按上述设定，排出所有要生成的项目：
    - 基地/场地/坐席开始
    - 基地/场地/坐席开始 + 1
    - 基地/场地/坐席开始 + 2
    - ...
    - 基地/场地/坐席结束
- 检查上述要生成的项目在数据库中是否有重复（历史字段 X/Y/Z 组合不可重复）
- 向数据写入上述要生成的项目
- 向用户展示本次生成的结果（明细）

生成结束后用户点击确认按钮后跳转到列表页面。
