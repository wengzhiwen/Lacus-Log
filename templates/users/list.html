{% extends 'base.html' %}
{% block title %}ç”¨æˆ·ç®¡ç† - Lacus-Log{% endblock %}
{% block content %}
<section class="user-management">
  <div class="page-header">
    <h1 class="page-title">ç”¨æˆ·ç®¡ç†</h1>
    <a class="btn btn-primary" href="{{ url_for('admin.users_new') }}">
      <span class="btn-icon">+</span>
      æ–°å¢è¿è¥
    </a>
  </div>

  <div class="filter-bar">
    <form class="filter-form" method="get">
      <div class="filter-group">
        <label class="filter-label">è§’è‰²ç­›é€‰</label>
        <select class="filter-select" name="role" onchange="this.form.submit()">
          <option value="">å…¨éƒ¨ç”¨æˆ·</option>
          <option value="gicho" {% if selected_role=='gicho' %}selected{% endif %}>ç®¡ç†å‘˜</option>
          <option value="kancho" {% if selected_role=='kancho' %}selected{% endif %}>è¿è¥</option>
        </select>
      </div>
    </form>
  </div>

  <div class="user-list">
    {% if users %}
      <div class="user-cards">
        {% for u in users %}
        <a href="{{ url_for('admin.users_detail', user_id=(u.id|string)) }}" class="user-card">
          <div class="card-header">
            <div class="user-info">
              <div class="user-name">{{ u.username }}</div>
              <div class="user-nickname">{{ u.nickname or 'æœªè®¾ç½®æ˜µç§°' }}</div>
            </div>
            <div class="user-badges">
              <span class="role-badge role-{{ (u.roles | map(attribute='name') | list) | first or 'unknown' }}">
                {{ ((u.roles | map(attribute='name') | list) | first or 'unknown') | role_display_name }}
              </span>
              <span class="status-badge status-{{ 'active' if u.active else 'inactive' }}">
                {{ 'å¯ç”¨' if u.active else 'åœç”¨' }}
              </span>
            </div>
          </div>
          <div class="card-footer">
            <div class="card-arrow">â†’</div>
          </div>
        </a>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty-state">
        <div class="empty-icon">ğŸ‘¥</div>
        <div class="empty-title">æš‚æ— ç”¨æˆ·</div>
        <div class="empty-description">ç‚¹å‡»ä¸Šæ–¹"æ–°å¢è¿è¥"æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä¸ªç”¨æˆ·</div>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}
