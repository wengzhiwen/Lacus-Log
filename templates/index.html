{% extends 'base.html' %}
{% block title %}首页 - Lacus-Log{% endblock %}
{% block content %}
<section class="dashboard">
  <h1 class="title">仪表盘</h1>
  <div class="cards">
    <div class="card" id="todayCard" style="cursor: pointer;">
      <div class="card-header">
        <div class="card-title">作战计划统计</div>
        <div class="card-icon">📊</div>
      </div>
      <div class="card-body">
        <div class="main-data">
          <div class="main-value">{{ dashboard_data.today_count }}</div>
          <div class="main-label">今日作战计划</div>
        </div>
        <div class="sub-data">
          <div class="sub-item">
            <div class="sub-value {% if dashboard_data.change_rate >= 0 %}positive{% else %}negative{% endif %}">
              {% if dashboard_data.change_rate >= 0 %}+{% endif %}{{ dashboard_data.change_rate }}%
            </div>
            <div class="sub-label">环比</div>
          </div>
          <div class="sub-item">
            <div class="sub-value">{{ dashboard_data.week_avg }}</div>
            <div class="sub-label">7日平均</div>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        <div class="card-title">作战记录统计</div>
        <div class="card-icon">📈</div>
      </div>
      <div class="card-body">
        <div class="main-data">
          <div class="main-value">{{ dashboard_data.battle_today_count }}</div>
          <div class="main-label">今日作战记录</div>
        </div>
        <div class="sub-data">
          <div class="sub-item">
            <div class="sub-value {% if dashboard_data.battle_change_rate >= 0 %}positive{% else %}negative{% endif %}">
              {% if dashboard_data.battle_change_rate >= 0 %}+{% endif %}{{ dashboard_data.battle_change_rate }}%
            </div>
            <div class="sub-label">环比</div>
          </div>
          <div class="sub-item">
            <div class="sub-value">{{ dashboard_data.battle_week_avg }}</div>
            <div class="sub-label">7日平均</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">机师统计</div>
        <div class="card-icon">👩‍✈️</div>
      </div>
      <div class="card-body">
        <div class="main-data">
          <div class="main-value">{{ dashboard_data.pilot_serving_count }}</div>
          <div class="main-label">服役人数</div>
        </div>
        <div class="sub-data">
          <div class="sub-item">
            <div class="sub-value">{{ dashboard_data.pilot_intern_serving_count }}</div>
            <div class="sub-label">实习机师</div>
          </div>
          <div class="sub-item">
            <div class="sub-value">{{ dashboard_data.pilot_official_serving_count }}</div>
            <div class="sub-label">正式机师</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div class="card-title">候补机师统计</div>
        <div class="card-icon">🧑‍🚀</div>
      </div>
      <div class="card-body">
        <div class="main-data">
          <div class="main-value">{{ dashboard_data.candidate_not_recruited_count }}</div>
          <div class="main-label">候补人数</div>
        </div>
        <div class="sub-data">
          <div class="sub-item">
            <div class="sub-value">{{ dashboard_data.trainee_serving_count }}</div>
            <div class="sub-label">训练机师</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // 设置今日作战计划卡片的点击事件
  const todayCard = document.getElementById('todayCard');
  if (todayCard) {
    const today = new Date().toISOString().split('T')[0];
    todayCard.addEventListener('click', function() {
      window.location.href = '{{ url_for('calendar.day_view') }}?date=' + today;
    });
  }
});
</script>
{% endblock %}

